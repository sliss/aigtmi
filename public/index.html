<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Startup Prospect Score Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }

    textarea {
      width: 100%;
      height: 100px;
    }

    button {
      margin-top: 10px;
    }

    #results {
      margin-top: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th,
    td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }

    th {
      background-color: #f2f2f2;
    }

    .status-active {
      background-color: #4a90e2;
      color: white;
    }

    .status-ipo {
      background-color: #ffd700;
    }

    .status-acquired {
      background-color: #66bb6a;
      color: white;
    }

    .status-inactive {
      background-color: #e57373;
      color: white;
    }
  </style>
</head>

<body>
  <h1>Startup Prospect Score Calculator</h1>
  <textarea id="description" placeholder="Enter your startup description here..."></textarea>
  <button onclick="calculateProspect()">Calculate Prospect Score</button>
  <div id="results"></div>

  <script>
    async function calculateProspect() {
      const description = document.getElementById('description').value;
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = 'Calculating...';

      try {
        const response = await fetch('/api/calculate-prospect', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ description }),
        });

        const data = await response.json();

        let resultsHtml = `
          <h2>Results</h2>
          <p>Prospect Score: ${data.prospectScore.toFixed(2)}</p>
          <p>Percentile: ${data.prospectPercentile.toFixed(2)}%</p>
          <p>Neighbor Acquisitions: ${data.numNeighborAcquisitions}</p>
          <p>Neighbor IPOs: ${data.numNeighborIPOs}</p>
          <p>Neighbor Failures: ${data.numNeighborFailures}</p>
          <h3>Nearest Neighbors</h3>
          <table>
            <tr>
              <th>Name</th>
              <th>Description</th>
              <th>Status</th>
              <th>Prospect Score</th>
              <th>Percentile</th>
            </tr>
        `;

        data.neighbors.forEach(neighbor => {
          const statusClass = getStatusClass(neighbor.status);
          resultsHtml += `
            <tr>
              <td><a href="${neighbor.website}" target="_blank">${neighbor.name}</a></td>
              <td>${neighbor.oneLiner}</td>
              <td class="${statusClass}">${neighbor.status}</td>
              <td>${neighbor.prospectScore ? neighbor.prospectScore.toFixed(2) : 'N/A'}</td>
              <td>${neighbor.prospectPercentile ? neighbor.prospectPercentile.toFixed(2) + '%' : 'N/A'}</td>
            </tr>
          `;
        });

        resultsHtml += '</table>';
        resultsDiv.innerHTML = resultsHtml;
      } catch (error) {
        resultsDiv.innerHTML = 'An error occurred while calculating the prospect score.';
        console.error('Error:', error);
      }
    }

    function getStatusClass(status) {
      switch (status.toLowerCase()) {
        case 'active':
          return 'status-active';
        case 'ipo':
          return 'status-ipo';
        case 'acquired':
          return 'status-acquired';
        case 'inactive':
          return 'status-inactive';
        default:
          return '';
      }
    }
  </script>
</body>

</html>